import{initializeApp as x}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";import{getAuth as A,GoogleAuthProvider as f,signInWithRedirect as R,getRedirectResult as w,onAuthStateChanged as h}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-auth.js";import{getDatabase as m,ref as i,onValue as u,set as B,remove as P}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-database.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const d of t.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}})();document.getElementById("textwhpform");const v=x({apiKey:"AIzaSyA58GQ4lc3s8BVZECdGvBgEyeoGqs3PAXw",authDomain:"gmynimaxiproductos.firebaseapp.com",databaseURL:"https://gmynimaxiproductos-default-rtdb.firebaseio.com",projectId:"gmynimaxiproductos",storageBucket:"gmynimaxiproductos.firebasestorage.app",messagingSenderId:"298345288781",appId:"1:298345288781:web:f922cbe731ef41c2f4f804",measurementId:"G-WL73MRRKNM"}),y=A(v),D=new f(v),k=document.getElementById("accedergoogle"),N=document.getElementById("cerrarsesion"),O=document.getElementById("emailinisesion"),C=document.getElementById("logininac"),T=document.getElementById("loginac");document.getElementById("idinfo");const G=document.getElementById("loginactivo");document.getElementById("cmdlimpiar");document.getElementById("textwhpform");document.getElementById("resultado");document.getElementById("idresout");document.getElementById("cmdgrabaregcontacti");m();document.getElementById("roleDisplay");document.getElementById("adminActionBtn");document.getElementById("adminPanel");document.getElementById("assignRoleBtn");k.addEventListener("click",c=>{R(y,D),w(y).then(n=>{f.credentialFromResult(n).accessToken,n.user}).catch(n=>{n.code,n.message,f.credentialFromError(n)})});N.addEventListener("click",c=>{y.signOut().then(()=>{document.getElementById("login").style.display="block",document.getElementById("accedergoogle").style.display="block",document.getElementById("cerrarsesion").style.display="none",document.getElementById("emailinisesion").innerText="Email",window.location.reload()}).catch(n=>{console.error("Error al cerrar sesiÃ³n:",n)})});h(y,async c=>{if(c){const n=c.uid,r=c.displayName,o=c.email,e=btoa(o),t=m(),d=i(t,"usuario/idkey:"+e);u(d,l=>{if(l.val()!==null){const s=i(t,`usuario/idkey:${e}/role`);u(s,L=>{let g=L.val();g==null&&(g="Rol de Usuario. No Asignado."),document.getElementById("roleusuario").innerText=g,g=="admin"?document.getElementById("botones-container").display="block":document.getElementById("botones-container").display="none"}),document.getElementById("login").style.display="none",document.getElementById("loginactivo").style.display="block",document.getElementById("accedergoogle").style.display="none",document.getElementById("cerrarsesion").style.display="block",document.getElementById("emailinisesion").innerText=o,document.getElementById("logininac").style.display="none"}else{document.getElementById("login").style.display="block",document.getElementById("loginactivo").style.display="none",document.getElementById("cerrarsesion").style.display="none",document.getElementById("emailinisesion").innerText="Email",document.getElementById("logininac").style.display="block";const s="usuario/idkey:"+e;B(i(t,s),{nombre:r,email:o,key:n,idrol:4,idnivel:2})}})}else k.style.display="block",G.style.display="none",O.style.display="none",N.style.display="none",C.style.display="block",T.style.display="none"});document.getElementById("");const p=document.getElementById("product-list"),a=document.getElementById("product-name"),S=document.getElementById("idbtnadd"),E=document.getElementById("idbtngrabar"),j=document.getElementById("idbtneliminar"),I=document.getElementById("idbtnedit"),F=document.getElementById("idbtnuevo"),M="";h(y,c=>{if(c){c.getIdTokenResult().then(o=>{const e=o.token,t=o.claims;console.log("Token de ID:",e),console.log("Claims:",t)}).catch(o=>{console.error("Error al obtener el resultado del token de ID:",o)}),S.addEventListener("click",o=>{const e=a.value;if(e.trim()!==""){const t=m(),d=i(t,"productos/producto:"+e);u(d,l=>{if(l.val()==null){const s="productos/producto:"+e;B(i(t,s),{nombre:e})}else console.log("Nombre Producto No Existe!")})}else console.log("Digite Nombre Producto")}),j.addEventListener("click",o=>{const e=a.value;if(e.trim()!==""){const t=m(),d=i(t,"productos/producto:"+e);P(d).then(()=>{localStorage.removeItem(a.value),window.location.reload(),console.log("Registro eliminado correctamente")}).catch(l=>{console.error("Error al eliminar el registro:",l)})}else console.log("Digite Nombre Producto")}),I.addEventListener("click",o=>{a.value.trim()!==""?(E.style.display="block",I.style.display="none"):console.log("Digite Nombre Producto")}),E.addEventListener("click",o=>{const e=a.value;if(e.trim()!==""){const t=m(),d=i(t,"productos/producto:"+M);u(d,l=>{if(l.val()!==null){const s="productos/producto:"+e;B(i(t,s),{nombre:e})}})}else console.log("Digite Nombre Producto")}),F.addEventListener("click",o=>{I.style.display="block",E.style.display="none",a.value=""});const n=m(),r=i(n,"productos");u(r,o=>{p.innerHTML="";const e=o.val();if(e)Object.keys(e).forEach(t=>{const d=e[t],l=document.createElement("li");l.classList.add("list-group-item"),l.textContent=d.nombre,p.appendChild(l)});else{const t=document.createElement("li");t.classList.add("list-group-item"),t.textContent="No hay productos registrados.",p.appendChild(t)}})}else console.log("No hay usuario autenticado")});document.getElementById("ejecutarFuncion");document.getElementById("textwhpform");document.getElementById("resultado");document.getElementById("textwhpform");document.getElementById("resultado");document.getElementById("idresout");document.getElementById("idjsondata");document.getElementById("idinfo");
