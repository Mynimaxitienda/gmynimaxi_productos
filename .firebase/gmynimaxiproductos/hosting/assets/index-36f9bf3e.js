import{initializeApp as P}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-app.js";import{getAuth as A,GoogleAuthProvider as f,signInWithRedirect as w,getRedirectResult as R,onAuthStateChanged as h}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-auth.js";import{getDatabase as m,ref as s,onValue as u,set as B,remove as T}from"https://www.gstatic.com/firebasejs/11.3.1/firebase-database.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const d of t.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=a(e);fetch(e.href,t)}})();document.getElementById("textwhpform");const k=P({apiKey:"AIzaSyA58GQ4lc3s8BVZECdGvBgEyeoGqs3PAXw",authDomain:"gmynimaxiproductos.firebaseapp.com",databaseURL:"https://gmynimaxiproductos-default-rtdb.firebaseio.com",projectId:"gmynimaxiproductos",storageBucket:"gmynimaxiproductos.firebasestorage.app",messagingSenderId:"298345288781",appId:"1:298345288781:web:f922cbe731ef41c2f4f804",measurementId:"G-WL73MRRKNM"}),y=A(k),D=new f(k),N=document.getElementById("accedergoogle"),L=document.getElementById("cerrarsesion"),O=document.getElementById("emailinisesion"),C=document.getElementById("logininac"),S=document.getElementById("loginac");document.getElementById("idinfo");const G=document.getElementById("loginactivo");document.getElementById("cmdlimpiar");document.getElementById("textwhpform");document.getElementById("resultado");document.getElementById("idresout");document.getElementById("cmdgrabaregcontacti");m();document.getElementById("roleDisplay");document.getElementById("adminActionBtn");document.getElementById("adminPanel");document.getElementById("assignRoleBtn");N.addEventListener("click",i=>{w(y,D),R(y).then(n=>{f.credentialFromResult(n).accessToken,n.user}).catch(n=>{n.code,n.message,f.credentialFromError(n)})});L.addEventListener("click",i=>{y.signOut().then(()=>{document.getElementById("login").style.display="block",document.getElementById("accedergoogle").style.display="block",document.getElementById("cerrarsesion").style.display="none",document.getElementById("emailinisesion").innerText="Email",window.location.reload()}).catch(n=>{console.error("Error al cerrar sesión:",n)})});h(y,async i=>{if(i){const n=i.uid,a=i.displayName,o=i.email,e=btoa(o),t=m(),d=s(t,"usuario/idkey:"+e);u(d,l=>{if(l.val()!==null){const r=s(t,`usuario/idkey:${e}/role`);u(r,x=>{let g=x.val();g==null&&(g="Acceso Público."),document.getElementById("roleusuario").innerText=g,g=="admin"?document.getElementById("botones-container").display="block":document.getElementById("botones-container").display="none"}),document.getElementById("login").style.display="none",document.getElementById("loginactivo").style.display="block",document.getElementById("accedergoogle").style.display="none",document.getElementById("cerrarsesion").style.display="block",document.getElementById("emailinisesion").innerText=o,document.getElementById("logininac").style.display="none"}else{document.getElementById("login").style.display="block",document.getElementById("loginactivo").style.display="none",document.getElementById("cerrarsesion").style.display="none",document.getElementById("emailinisesion").innerText="Email",document.getElementById("logininac").style.display="block";const r="usuario/idkey:"+e;B(s(t,r),{nombre:a,email:o,key:n,idrol:4,idnivel:2})}})}else N.style.display="block",G.style.display="none",O.style.display="none",L.style.display="none",C.style.display="block",S.style.display="none"});document.getElementById("");const p=document.getElementById("product-list"),c=document.getElementById("product-name"),j=document.getElementById("idbtnadd"),E=document.getElementById("idbtngrabar"),v=document.getElementById("idbtneliminar"),I=document.getElementById("idbtnedit"),F=document.getElementById("idbtnuevo"),M="";h(y,i=>{if(i){i.getIdTokenResult().then(o=>{const e=o.token,t=o.claims;console.log("Token de ID:",e),console.log("Claims:",t)}).catch(o=>{console.error("Error al obtener el resultado del token de ID:",o)}),j.addEventListener("click",o=>{const e=c.value;if(e.trim()!==""){const t=m(),d=s(t,"productos/producto:"+e);u(d,l=>{if(l.val()==null){const r="productos/producto:"+e;B(s(t,r),{nombre:e}),localStorage.removeItem(c.value),document.getElementById("idproducname").innerText="Nombre Producto : "+e,c.value="",c.focus()}else console.log("Nombre Producto No Existe!")})}else console.log("Digite Nombre Producto")}),v.addEventListener("click",o=>{const e=c.value;if(e.trim()!==""){const t=m(),d=s(t,"productos/producto:"+e);T(d).then(()=>{document.getElementById("product-name").innerText="",localStorage.removeItem(c.value),window.location.reload(),console.log("Registro eliminado correctamente")}).catch(l=>{console.error("Error al eliminar el registro:",l)})}else console.log("Digite Nombre Producto")}),I.addEventListener("click",o=>{c.value.trim()!==""?(E.style.display="block",I.style.display="none"):console.log("Digite Nombre Producto")}),E.addEventListener("click",o=>{const e=c.value;if(e.trim()!==""){const t=m(),d=s(t,"productos/producto:"+M);u(d,l=>{if(l.val()!==null){const r="productos/producto:"+e;B(s(t,r),{nombre:e})}})}else console.log("Digite Nombre Producto")}),F.addEventListener("click",o=>{I.style.display="none",E.style.display="none",v.style.display="none",document.getElementById("idproducname").innerText="Nombre Producto : ",c.value="",c.focus()});const n=m(),a=s(n,"productos");u(a,o=>{p.innerHTML="";const e=o.val();if(e)Object.keys(e).forEach(t=>{const d=e[t],l=document.createElement("li");l.classList.add("list-group-item"),l.textContent=d.nombre,p.appendChild(l),l.setAttribute("data-id",t),l.addEventListener("click",()=>{c.value=d.nombre,c.focus()})});else{const t=document.createElement("li");t.classList.add("list-group-item"),t.textContent="No hay productos registrados.",p.appendChild(t)}})}else console.log("No hay usuario autenticado")});document.getElementById("ejecutarFuncion");document.getElementById("textwhpform");document.getElementById("resultado");document.getElementById("textwhpform");document.getElementById("resultado");document.getElementById("idresout");document.getElementById("idjsondata");document.getElementById("idinfo");
